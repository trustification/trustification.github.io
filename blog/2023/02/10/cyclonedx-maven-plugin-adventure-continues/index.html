<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Continuing the Adventure with the CycloneDX Maven Plugin | Trustification</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://trustification.io/img/logo.svg"><meta data-rh="true" name="twitter:image" content="https://trustification.io/img/logo.svg"><meta data-rh="true" property="og:url" content="https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="supply chain, sbom, vex"><meta data-rh="true" property="og:title" content="Continuing the Adventure with the CycloneDX Maven Plugin | Trustification"><meta data-rh="true" name="description" content="My investigation into the CycloneDX Maven Plugin began back in November/December 2022 with the intent of integrating the plugin into the Quarkus build process to generate Software Bill of Materials (SBOMs) for the project. I quickly discovered issues in the plugin and raised these with the maintainer early in December, writing a blog post (An Adventure with the CycloneDX Maven Plugin) to help clarify each issue. I finally opened a pull request in early January to move the conversation forward and this is where our story continues ....."><meta data-rh="true" property="og:description" content="My investigation into the CycloneDX Maven Plugin began back in November/December 2022 with the intent of integrating the plugin into the Quarkus build process to generate Software Bill of Materials (SBOMs) for the project. I quickly discovered issues in the plugin and raised these with the maintainer early in December, writing a blog post (An Adventure with the CycloneDX Maven Plugin) to help clarify each issue. I finally opened a pull request in early January to move the conversation forward and this is where our story continues ....."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-02-10T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/knrc"><meta data-rh="true" property="article:tag" content="cyclonedx"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues"><link data-rh="true" rel="alternate" href="https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues" hreflang="en"><link data-rh="true" rel="alternate" href="https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UO35LKIYPP-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues","mainEntityOfPage":"https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues","url":"https://trustification.io/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues","headline":"Continuing the Adventure with the CycloneDX Maven Plugin","name":"Continuing the Adventure with the CycloneDX Maven Plugin","description":"My investigation into the CycloneDX Maven Plugin began back in November/December 2022 with the intent of integrating the plugin into the Quarkus build process to generate Software Bill of Materials (SBOMs) for the project. I quickly discovered issues in the plugin and raised these with the maintainer early in December, writing a blog post (An Adventure with the CycloneDX Maven Plugin) to help clarify each issue. I finally opened a pull request in early January to move the conversation forward and this is where our story continues .....","datePublished":"2023-02-10T00:00:00.000Z","author":{"@type":"Person","name":"Kevin Conner","description":"Maintainer","url":"https://github.com/knrc","image":"https://github.com/knrc.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://trustification.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Trustification RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Trustification Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HWS6R519CF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-HWS6R519CF",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Trustification" href="/opensearch.xml">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Text&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Text:wght@400;700&display=swap"><link rel="stylesheet" href="/assets/css/styles.100c697b.css">
<script src="/assets/js/runtime~main.dfa7b775.js" defer="defer"></script>
<script src="/assets/js/main.ed5b168d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Trustification Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Trustification Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Trustification</b></a><a href="https://docs.trustification.dev/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/trustification" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/07/04/release-0-1-0-alpha-10">Trustify: Release 0.1.0-alpha.10</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/06/27/trying-out-trustify">Trying out Trustify, on a local machine</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/03/20/cyclonedx-maven-aggregate-bom-why-not-to-trust">The CycloneDX Maven Aggregate SBOM and why you shouldn&#x27;t trust it (yet)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/03/13/in-toto-attestations">in-toto attestations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/02/13/elfsign">Signing elf binaries, or not?! Lessons learned.</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues">Continuing the Adventure with the CycloneDX Maven Plugin</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/31/tuf">The Update Framework (TUF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/25/keys">Is this a cryptographic key which I see before me?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/13/sigstore-bundle-format">Sigstore bundle format</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/11/sigstore-in-toto-opa">Sigstore, in-toto, OPA, orientation</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Continuing the Adventure with the CycloneDX Maven Plugin</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-02-10T00:00:00.000Z">February 10, 2023</time> · <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/knrc" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/knrc.png" alt="Kevin Conner"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/knrc" target="_blank" rel="noopener noreferrer"><span>Kevin Conner</span></a></div><small class="avatar__subtitle">Maintainer</small></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>My investigation into the <a href="https://github.com/CycloneDX/cyclonedx-maven-plugin" target="_blank" rel="noopener noreferrer" title="The CycloneDX Maven Plugin GitHub repository">CycloneDX Maven Plugin</a> began back in November/December 2022 with the intent of integrating the plugin into the <a href="https://github.com/quarkusio/quarkus" target="_blank" rel="noopener noreferrer" title="The Quarkus GitHub repository">Quarkus</a> build process to generate Software Bill of Materials (SBOMs) for the project. I quickly discovered issues in the plugin and raised these with the maintainer early in December, writing a blog post (<a href="/blog/2022/12/09/cyclonedx-maven-plugin-adventure">An Adventure with the CycloneDX Maven Plugin</a>) to help clarify each issue. I finally opened a pull request in early January to move the conversation forward and this is where our story continues .....</p>
<p>Two weeks ago I received some feedback on the pull request from Steve Springett, he ran my version of the CycloneDX plugin and hit some problems. Steve was running the plugin against the <a href="https://github.com/WebGoat/WebGoat/tree/v8.0.0" target="_blank" rel="noopener noreferrer">WebGoat 8.0.0</a> codebase and noticed some dependencies were not present in the components section! This was intriguing as I had been running the plugin against a complex codebase (<a href="https://github.com/quarkusio/quarkus" target="_blank" rel="noopener noreferrer" title="The Quarkus GitHub repository">Quarkus</a>) without seeing the issue, and had also included a BOM validation step in my pull request which would emit <strong>WARNING</strong> log messages if this situation occurred. I took a look at the WebGoat codebase and could not get this specific version to build, however a build of a different version did succeed without displaying the problem. Curiouser and curiouser .......</p>
<p>We now jump forward to this Monday (4 days ago) when I&#x27;m trying to arrange a call with Steve to discuss the differences in our environments and help move this forward. Steve suggested we include Hervé Boutemy in the call, the new maintainer of the upstream codebase, however he offered instead to review my pull request as-is. It&#x27;s at this point I realised the pull request now had conflicts with the base branch, so I quickly rebased and fixed the conflicts. I also decided to give the WebGoat codebase another try.</p>
<p>I spent time investigating the failures I had seen with the WebGoat build and eventually realised I needed to be running on an older version of Java, I needed to install JDK8 in order to make progress. I was now able to build the same version of the code Steve had been using, although with errors, but could now see missing components. Even better, I could also see the expected <strong>WARNING</strong> messages were present!</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[WARNING] CycloneDX: Dependency missing component entry: pkg:maven/org.webjars/jquery@1.11.1?type=jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARNING] CycloneDX: Dependency missing component entry: pkg:maven/commons-io/commons-io@LATEST?type=jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARNING] CycloneDX: Dependency missing component entry: pkg:maven/com.google.guava/guava@18.0?type=jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARNING] CycloneDX: Dependency missing component entry: pkg:maven/org.apache.commons/commons-lang3@3.4?type=jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This was great, I now had something to work with.</p>
<h1>Comparing Upstream Output with my pull request</h1>
<p>Before investigating I decided to first understand the differences in output between the current upstream codebase and what was being generated by my pull request. This may provide some insight into the new issue and could possibly hint at a direction to follow.</p>
<p>With regard to <strong>components</strong> I discovered three were missing from my version of the bom, however in each case the component was never referenced in the dependencies section. These components were</p>
<ul>
<li>pkg<!-- -->:maven<!-- -->/com.google.guava/guava@20.0?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/commons-io/commons-io@2.11.0?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.apache.commons/commons-lang3@3.6?type=jar</li>
</ul>
<p>These are three of the components we were warned about, but suspiciously each has a different version.</p>
<p>I also found we were now including two additional <strong>components</strong>, these are</p>
<ul>
<li>pkg<!-- -->:maven<!-- -->/junit/junit@4.12?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.hamcrest/hamcrest-core@1.3?type=jar</li>
</ul>
<p>With regard to <strong>dependencies</strong> we were expanding the dependency tree to include transitive dependencies for the following</p>
<ul>
<li>pkg<!-- -->:maven<!-- -->/com.fasterxml.jackson.core/jackson-databind@2.8.11.1?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework.boot/spring-<a href="mailto:boot-autoconfigure@1.5.12.RELEASE" target="_blank" rel="noopener noreferrer">boot-autoconfigure@1.5.12.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework.boot/spring-<a href="mailto:boot@1.5.12.RELEASE" target="_blank" rel="noopener noreferrer">boot@1.5.12.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework.security/spring-<a href="mailto:security-core@4.2.5.RELEASE" target="_blank" rel="noopener noreferrer">security-core@4.2.5.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework.security/spring-<a href="mailto:security-web@4.2.5.RELEASE" target="_blank" rel="noopener noreferrer">security-web@4.2.5.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework/spring-<a href="mailto:aop@4.3.16.RELEASE" target="_blank" rel="noopener noreferrer">aop@4.3.16.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework/spring-<a href="mailto:beans@4.3.16.RELEASE" target="_blank" rel="noopener noreferrer">beans@4.3.16.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework/spring-<a href="mailto:context@4.3.16.RELEASE" target="_blank" rel="noopener noreferrer">context@4.3.16.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework/spring-<a href="mailto:expression@4.3.16.RELEASE" target="_blank" rel="noopener noreferrer">expression@4.3.16.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework/spring-<a href="mailto:test@4.3.16.RELEASE" target="_blank" rel="noopener noreferrer">test@4.3.16.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.springframework/spring-<a href="mailto:web@4.3.16.RELEASE" target="_blank" rel="noopener noreferrer">web@4.3.16.RELEASE</a>?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.webjars/bootstrap@3.3.7?type=jar</li>
</ul>
<p>as well as adding new <strong>dependencies</strong> into the tree</p>
<ul>
<li>pkg<!-- -->:maven<!-- -->/aopalliance/aopalliance@1.0?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.hamcrest/hamcrest-core@1.3?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/junit/junit@4.12?type=jar</li>
</ul>
<p>however, we are also seeing the following <strong>dependencies</strong> without any mention in the <strong>component</strong> section</p>
<ul>
<li>pkg<!-- -->:maven<!-- -->/com.google.guava/guava@18.0?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/commons-io/commons-io@LATEST?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.apache.commons/commons-lang3@3.4?type=jar</li>
<li>pkg<!-- -->:maven<!-- -->/org.webjars/jquery@1.11.1?type=jar</li>
</ul>
<p>These match the list of <strong>dependencies</strong> reported as <strong>WARNING</strong>s in the log, confirming the issue.</p>
<p>We now know the pull request codebase is having a beneficial effect and providing a more detailed dependency graph. What is left to work out is why we are seeing these four dependencies in the tree with no associated component.</p>
<h1>Identity, Does it Matter?</h1>
<p>Before we take a look at each of the problematic dependencies let us quickly cover how components are identified in the upstream CycloneDX codebase and in my pull request.</p>
<p>The upstream codebase discovers its components by asking maven for those artifacts which it has resolved to be the definitive set for the build. These artifacts are then filtered based on their scope, however as we discovered in the previous post this does not follow the transitive scoping rules applied by maven, and then used to create the set of components included in the bom file. It is also important to realise that when resolving the dependency tree the upstream codebase will not include any dependencies which do not exist in the set of known components. No components will be removed, even if they do not take part in the dependency tree.</p>
<p>In my pull request we take a slightly different approach. To discover the set of possible components we still ask maven for the definitive set of artifacts, but rely instead on maven to handle the filtering when collecting the dependency graph. At the end of the process we check the set of components and remove any which do not appear in the dependency tree. No dependencies will be removed, even if they do not have an associated component, however a warning is emitted on the console. This is the warning we are now seeing.</p>
<p>These approaches are, essentially, tackling the discovery from opposite directions.</p>
<p>With the above in mind let us now take a look at the problematic artifacts and return to our trusty dependency tree graph. We can see from the <strong>WARNING</strong>s that we should focus on two of the projects</p>
<ul>
<li><strong>xxe</strong> for <strong>guava</strong> and <strong>commons-lang3</strong></li>
<li><strong>webwolf</strong> for <strong>jquery</strong> and <strong>commons-io</strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-look-at-guava">A look at Guava<a class="hash-link" aria-label="Direct link to A look at Guava" title="Direct link to A look at Guava" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-guava">​</a></h2>
<p>The parts of the <strong>xxe</strong> dependency tree which are of interest are</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.owasp.webgoat.lesson:xxe:jar:v8.0.0.M15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- com.github.tomakehurst:wiremock:jar:2.8.0:test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- com.google.guava:guava:jar:20.0:provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- com.flipkart.zjsonpatch:zjsonpatch:jar:0.3.0:test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  |  +- (com.google.guava:guava:jar:18.0:test - omitted for conflict with 20.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- org.owasp.webgoat:webgoat-container:jar:v8.0.0.M15:provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- (com.google.guava:guava:jar:18.0:provided - omitted for conflict with 20.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- org.owasp.webgoat:webgoat-container:jar:tests:v8.0.0.M15:test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- (com.google.guava:guava:jar:18.0:test - omitted for conflict with 20.0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>From this we can see <strong>guava:20.0</strong> has been resolved as the winner by maven, however the winning artifact is hidden beneath a <strong>test</strong> scoped artifact (we saw this in our previous issues). We can also see the artifact discovered through the transitive <strong>compile</strong> scope is being reported as <strong>guava:18.0</strong>, so while version <strong>20.0</strong> has been declared the winner we are still seeing the marker nodes report the original version of <strong>18.0</strong>. How does each version of the plugin handle this scenario?</p>
<p>The upstream code discovers <strong>guava:20.0</strong> in the set of resolved artifacts, including it in its set of known components. When creating the dependency tree it discovers <strong>guava:18.0</strong>, however decides not to include it as this version is not in the set of known components. This results in a bom which includes the <strong>guava:20.0</strong> component and a dependency graph which does not reference the <strong>guava</strong> dependency, losing the dependency relationship between <strong>webgoat-container</strong> and <strong>guava</strong>. The bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/com.google.guava/guava@20.0?type=jar&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In my pull request we discover <strong>guava:20.0</strong> in the set of resolved artifacts, including it as a known component. When creating the dependency tree we discover the <strong>guava:18.0</strong> dependency and include it in the tree. At the end of the process we drop components which are not mentioned in the dependency tree, in this instance the <strong>guava:20.0</strong> component, but keep the dependency relationship between <strong>webgoat-container</strong> and <strong>guava:18.0</strong>, which is a missing component. The bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webgoat-container@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/com.google.guava/guava@18.0?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/com.google.guava/guava@18.0?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-look-at-commons-lang3">A look at commons-lang3<a class="hash-link" aria-label="Direct link to A look at commons-lang3" title="Direct link to A look at commons-lang3" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-commons-lang3">​</a></h2>
<p>The parts of the <strong>xxe</strong> dependency tree which are of interest are</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.owasp.webgoat.lesson:xxe:jar:v8.0.0.M15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- com.github.tomakehurst:wiremock:jar:2.8.0:test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- org.apache.commons:commons-lang3:jar:3.6:provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  \- com.github.jknack:handlebars:jar:4.0.6:test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     +- (org.apache.commons:commons-lang3:jar:3.1:test - omitted for conflict with 3.6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- org.owasp.webgoat:webgoat-container:jar:v8.0.0.M15:provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- (org.apache.commons:commons-lang3:jar:3.4:provided - omitted for conflict with 3.6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- org.owasp.webgoat:webgoat-container:jar:tests:v8.0.0.M15:test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  +- (org.apache.commons:commons-lang3:jar:3.4:test - omitted for conflict with 3.6)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can see from the above that the <strong>commons-lang3</strong> artifact suffers from the same problem as the <strong>guava</strong> artifact, with the artifact identified through the transitive <strong>compile</strong> scope having a version of <strong>3.4</strong> while the resolved winner has a version of <strong>3.6</strong> but is hidden beneath a <strong>test</strong> scoped artifact. We can also see there is a third version being referenced beneath the <strong>test</strong> scoped artifact, <strong>commons-lang3:3.1</strong>.</p>
<p>The upstream bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/org.apache.commons/commons-lang3@3.6?type=jar&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The bom from my pull request looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webgoat-container@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.apache.commons/commons-lang3@3.4?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.apache.commons/commons-lang3@3.4?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-look-at-jquery">A look at jquery<a class="hash-link" aria-label="Direct link to A look at jquery" title="Direct link to A look at jquery" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-jquery">​</a></h2>
<p>The parts of the <strong>webwolf</strong> dependency tree which are of interest are</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.owasp.webgoat:webwolf:jar:v8.0.0.M15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- org.webjars:bootstrap:jar:3.3.7:compile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  \- (org.webjars:jquery:jar:1.11.1:compile - omitted for conflict with 3.2.1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- org.webjars:jquery:jar:3.2.1:compile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This scenario is slightly different from the previous ones in that the resolved component is not hidden behind a <strong>test</strong> scoped artifact. We can see from the above that we have two artifacts being discovered within the transitive <strong>compile</strong> scope, <strong>jquery:3.2.1</strong> and <strong>jquery:1.11.1</strong>. Version <strong>3.2.1</strong> is the resolved winner and version <strong>1.11.1</strong> is the marker node for an artifact which lost the resolution process. How does each version of the plugin handle this scenario?</p>
<p>The upstream code discovers <strong>jquery:3.2.1</strong> in the set of resolved artifacts, including it in its set of known components. When creating the dependency tree it discovers both <strong>jquery:3.2.1</strong> and <strong>jquery:1.11.1</strong>, including <strong>3.2.1</strong> in the tree but deciding not to include <strong>1.11.1</strong> as this does not match a known component. This results in a bom which includes the <strong>jquery:3.2.1</strong> component and the dependency relationship between <strong>webwolf</strong> and <strong>jquery</strong> but loses the dependency relationship between <strong>bootstrap</strong> and <strong>jquery</strong>. The bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webwolf@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In my pull request we discover <strong>jquery:3.2.1</strong> in the set of resolved artifacts, including it as a known component. When creating the dependency tree we discover both <strong>jquery:3.2.1</strong> and <strong>jquery:1.11.1</strong>, including both in the tree. This results in a bom which includes the <strong>jquery:3.2.1</strong> component and the dependency relationship between <strong>webwolf</strong> and <strong>jquery</strong>. The bom also keeps the dependency relationship between <strong>bootstrap</strong> and <strong>jquery:1.11.1</strong>, which is a missing component. The bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webwolf@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.webjars/bootstrap@3.3.7?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@1.11.1?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@1.11.1?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-look-at-commons-io">A look at commons-io<a class="hash-link" aria-label="Direct link to A look at commons-io" title="Direct link to A look at commons-io" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-commons-io">​</a></h2>
<p>The parts of the <strong>webwolf</strong> dependency tree which are of interest are</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.owasp.webgoat:webwolf:jar:v8.0.0.M15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+- commons-io:commons-io:jar:LATEST:compile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now this scenario is very different from the previous ones. In each of the previous scenarios the dependency tree included marker nodes with versions which did not match the version resolved by maven, the first two with the resolved artifact hidden behind a <strong>test</strong> scoped artifact and the third with both artifacts discovered through the transitive <strong>compile</strong> scope. So what is going on here? It&#x27;s time for a quick dive under the covers of maven!</p>
<p>Maven includes support for two <em>metaversions</em> which can be used when specifying the version of an artifact, these are <strong>RELEASE</strong> and <strong>LATEST</strong>. These <em>metaversions</em> have specific meanings when resolving artifacts within a pom, these are</p>
<ul>
<li><strong>RELEASE</strong>: represents the latest non-snapshot version of the artifact within a repository</li>
<li><strong>LATEST</strong>: represents the latest version of the artifact within a repository, which includes both released and snapshot versions</li>
</ul>
<hr>
<p><strong>Note:</strong> Using either <strong>RELEASE</strong> or <strong>LATEST</strong> in a build breaks reproducibility. Thankfully maven is now issuing the following deprecation <strong>WARNING</strong> when encountering these <em>metaversions</em>, which means support for these versions should be removed at some point in the future.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[WARNING] &#x27;dependencies.dependency.version&#x27; for commons-io:commons-io:jar is either LATEST or RELEASE (both of them are being deprecated)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<p>When maven encounters either of these <em>metaversions</em> it will resolve the artifact to a specific version based on the above meanings. In our case, at least as of today, maven will resolve <strong>commons-io<!-- -->:LATEST</strong> to <strong>commons-io:2.11.0</strong>. How does each version of the plugin handle this scenario?</p>
<p>The upstream code discovers <strong>commons-io:2.11.0</strong> in the set of resolved artifacts, including it in its set of known components. When creating the dependency tree it discovers <strong>commons-io<!-- -->:LATEST</strong>, however decides not to include it as this version is not in the set of known components. This results in a bom which includes the <strong>commons-io:2.11.0</strong> component and a dependency graph which does not reference the <strong>common-io</strong> dependency, losing the dependency relationship between <strong>webwolf</strong> and <strong>commons-io</strong>. The bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/commons-io/commons-io@2.11.0?type=jar&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In my pull request we discover <strong>commons-io:2.11.0</strong> in the set of resolved artifacts, including it as a known component. When creating the dependency tree we discover the <strong>commons-io<!-- -->:LATEST</strong> dependency and include it in the tree. At the end of the process we drop components which are not mentioned in the dependency tree, in this instance the <strong>commons-io:2.11.0</strong> component, but keep the dependency relationship between <strong>webwolf</strong> and <strong>commons-io<!-- -->:LATEST</strong>, which is a missing component. The bom looks as follows</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webwolf@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/commons-io/commons-io@LATEST?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/commons-io/commons-io@LATEST?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summarising-the-issues">Summarising the issues<a class="hash-link" aria-label="Direct link to Summarising the issues" title="Direct link to Summarising the issues" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#summarising-the-issues">​</a></h2>
<p>We have three different scenarios here, however each has the same root cause. Maven is returning a dependency graph which includes marker nodes referencing the original artifact versions and not the versions resolved within the context of the build. These marker nodes have a different identity to the resolved dependencies and are, therefore, treated separately. As we would expect, identity does matter!</p>
<p>With the upstream codebase we see the resolved components being included in the bom, but with certain dependency relationships missing from the dependency tree.</p>
<p>With my pull request we see some missing components from the bom, but with all dependency relationships included in the dependency tree. The problem is that some of these relationships reference dependencies with their original version and not the version resolved by maven.</p>
<hr>
<p><strong>Note:</strong> The issues we are seeing do not happen with dependencies which have their version managed, if we look at the node for a managed dependency we can see the version of the marker has been updated</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.slf4j:slf4j-api:1.7.25:compile    (org.slf4j:slf4j-api:jar:1.7.25:compile - version managed from 1.6.6; omitted for duplicate)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this case the version of the marker node has been updated from <strong>1.6.6</strong> to <strong>1.7.25</strong>.</p>
<p>Unfortunately this additional information is not available to us other than through the <strong>toNodeString</strong> method on the <strong>VerboseDependencyNode</strong> class, that is unless we delve under the covers and work on the internal <em><a href="https://wiki.eclipse.org/Aether" target="_blank" rel="noopener noreferrer" title="Eclipse Aether website">aether</a></em> dependency tree which does contain a data map including this information.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="now-for-the-solution">Now for the solution<a class="hash-link" aria-label="Direct link to Now for the solution" title="Direct link to Now for the solution" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#now-for-the-solution">​</a></h2>
<p>Now we have identified a root cause there is an obvious solution. We know maven is not updating the versions for some marker nodes, leaving them with their original version, so we need to handle this aspect. We need to track the versions of the resolved artifacts and, when creating the dependency graph, ensure all dependency versions reference the resolved version of the artifact. Thankfully this is a straight forward update to the codebase.</p>
<p>Now that we have a working solution how does this look for each component?</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recap-and-solution-for-guava">Recap and Solution for guava<a class="hash-link" aria-label="Direct link to Recap and Solution for guava" title="Direct link to Recap and Solution for guava" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-guava">​</a></h3>
<p>From our earlier discussion we saw the upstream plugin had identified the correct guava version for the component, but had lost all dependency relationships, and my pull request had kept the dependency relationships but had lost the component as it was referring to the original version of the artifact. What do we see now in the bom file?</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/com.google.guava/guava@20.0?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webgoat-container@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/com.google.guava/guava@20.0?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/com.google.guava/guava@20.0?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Fantastic, we now see a component with the version resolved by maven and all the dependency relationships we were expecting!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recap-and-solution-for-commons-lang3">Recap and Solution for commons-lang3<a class="hash-link" aria-label="Direct link to Recap and Solution for commons-lang3" title="Direct link to Recap and Solution for commons-lang3" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-commons-lang3">​</a></h3>
<p>From our earlier discussion we saw a similar issue with commons-lang3. The upstream plugin had identified the correct commons-lang3 version for the component, but had lost all dependency relationships, and my pull request had kept the dependency relationships but had lost the component as it was using the original version of the artifact. What do we see now in the bom file?</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/org.apache.commons/commons-lang3@3.6?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webgoat-container@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.apache.commons/commons-lang3@3.6?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.apache.commons/commons-lang3@3.6?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We are now two for two, we again see the component with the resolved version and also see all the dependency relationships!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recap-and-solution-for-jquery">Recap and Solution for jquery<a class="hash-link" aria-label="Direct link to Recap and Solution for jquery" title="Direct link to Recap and Solution for jquery" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-jquery">​</a></h3>
<p>In our earlier discussion we had identified a slightly different scenario with jquery, as the <strong>compile</strong> scoped artifacts included both the resolved version (3.2.1) and an older version (1.11.1). Both plugins had identified the component and included the dependency relationship between <strong>webwolf</strong> and <strong>jquery</strong>, however the upstream plugin had lost the dependency relationship between <strong>bootstrap</strong> and <strong>jquery</strong> whereas my pull request included the dependency but referenced the original version. What do we now see in the bom file?</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webwolf@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.webjars/bootstrap@3.3.7?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.webjars/jquery@3.2.1?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We are on a roll, and are now three for three. We can see all the expected dependency relationships are present with all the relationships referencing the resolved version!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recap-and-solution-for-commons-io">Recap and Solution for commons-io<a class="hash-link" aria-label="Direct link to Recap and Solution for commons-io" title="Direct link to Recap and Solution for commons-io" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-commons-io">​</a></h3>
<p>Now we come to our final scenario and the use of <em>metaversions</em>, can we make it four for four?</p>
<p>In our earlier discussion we covered the use and meaning of <em>metaversions</em> within maven dependencies and saw the upstream plugin had correctly identified the resolved component, but had no dependency relationships, whereas my pull request identified the dependency relationships using the <strong>LATEST</strong> <em>metaversion</em> but did not identify the component. What do we now see in the bom file?</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;component type=&quot;library&quot; bom-ref=&quot;pkg:maven/commons-io/commons-io@2.11.0?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/org.owasp.webgoat/webwolf@v8.0.0.M15?type=jar&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;dependency ref=&quot;pkg:maven/commons-io/commons-io@2.11.0?type=jar&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency ref=&quot;pkg:maven/commons-io/commons-io@2.11.0?type=jar&quot;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Brilliant, the component and all expected dependency relationships are present, with each referencing the resolved version and not the <em>metaversion</em>!</p>
<p>We have done it, we are now four for four!</p>
<h1>Conclusions</h1>
<p>With this latest issue now resolved I feel we have a much better solution for generating SBOMs for maven projects. We know these bom files will contain all dependency relationships returned via maven, and now this version mismatch issue has been addressed we can be confident we will only include entries for resolved artifacts.</p>
<p>My original pull request has been updated to include the fix for these issues, in addition to the issues covered in the previous post (<a href="/blog/2022/12/09/cyclonedx-maven-plugin-adventure">An Adventure with the CycloneDX Maven Plugin</a>), and has now been merged into the upstream codebase with help from Hervé. I&#x27;m looking forward to having this released in the next <a href="https://github.com/CycloneDX/cyclonedx-maven-plugin" target="_blank" rel="noopener noreferrer" title="The CycloneDX Maven Plugin GitHub repository">CycloneDX Maven Plugin</a> release and being able to use this in earnest as part of our effort to secure our Software Supply Chain. With any luck this can also be of benefit to your efforts, at least I hope that proves to be the case.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cyclonedx">cyclonedx</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/trustification/trustification.github.io/tree/main/blog/2023-02-10-cyclonedx-maven-plugin-adventure-continues.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2023/02/13/elfsign"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Signing elf binaries, or not?! Lessons learned.</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2023/01/31/tuf"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">The Update Framework (TUF)</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-guava">A look at Guava</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-commons-lang3">A look at commons-lang3</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-jquery">A look at jquery</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#a-look-at-commons-io">A look at commons-io</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#summarising-the-issues">Summarising the issues</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#now-for-the-solution">Now for the solution</a><ul><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-guava">Recap and Solution for guava</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-commons-lang3">Recap and Solution for commons-lang3</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-jquery">Recap and Solution for jquery</a></li><li><a class="table-of-contents__link toc-highlight" href="/blog/2023/02/10/cyclonedx-maven-plugin-adventure-continues#recap-and-solution-for-commons-io">Recap and Solution for commons-io</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.trustification.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.element.io/?updated=1.11.32#/room/#trustification:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/trustification" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Trustification.</div></div></div></footer></div>
</body>
</html>